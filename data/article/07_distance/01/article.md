---
id: 01
type: source_and_text
---

## 概要

単位球面上の2点間の距離はどうやって測るのでしょう？平面上であれば、三平方の定理を用いることで距離を算出できますが・・・。

その答えは角度です。単位球面上の2点間の距離は、単位球面上にある2点をA,B、単位球の中心点をOとすると、OAとOBのなす角の値となります。

## 2 つの s2.LatLng 構造体の間の距離

s2.LatLng 構造体の Distance 関数により距離を計算します。

## 2 つの s2.Point 構造体の間の距離

s2.Point 構造体の Distance 関数により距離を計算します。

## 角度（ラジアン）からメートルへの変換

1 ラジアンのメートルは約6371010.0。[こちら](https://github.com/google/s2geometry/blob/efb124d8eaf3433323d3e877dedd5e94a63339a3/src/s2/s2earth.h#L104-L112)を参考にしています。

## 誤差について

s2 では地球を球とみなして幾何学計算を行います。しかしながら、地球は厳密には楕円です。なぜ楕円ではなく球とみなすのか？そうした方が、計算がより簡潔になり、計算にかかる計算量も小さくできるというメリットがあるからです。

ところが、地球を球とみなすことによるデメリットもあります。計算に誤差が出るということです。計算機上の計算結果が現実世界の距離とズレてしまうということを意味します。

距離においても誤差が生じます。s2 を用いたアプリケーションを組む場合、誤差が許容範囲内に収まっているかどうか？を事前に確認するようにしましょう。
